@page "/cookbook"
@using dominikz.dev.Shared.Cards
@using dominikz.dev.Shared.Collection
@using dominikz.dev.Shared.Tables
@using dominikz.dev.Utils
@using dominikz.kernel.ViewModels

<PageTitle>Cookbook</PageTitle>

<CollectionBar OrderKeys="_orderKeys"
               OnOrderChanged="OnOrderChanged"
               OnSearchChanged="OnSearchChanged"
               OnViewChanged="OnViewChanged" />

<CollectionFilterBar T="RecipeCategoryFlags"
                     Title="Category:"
                     AllowExpand=false
                     AllowMultiSelect=false
                     Values="Enum.GetValues<RecipeCategoryFlags>()[1..].ToList()"
                     TextAccessor="@((x) => EnumConverter.ToString(x))"
                     OnChanged="@OnCategoryChanged" />

<MatDivider />

<CollectionFilterBar T="FoodVM"
                     Title="Foods:"
                     Values="@_foods"
                     TextAccessor="@((x) => x.Title)"
                     OnChanged="@OnFoodsChanged" />

<Panel>
    @if (_view == CollectionView.Table)
    {
        <Table T="RecipeVM" 
            OnRowClicked="(x) => NavigateToDetail(x.Id)"
            Values="@_recipes" 
            Columns="@_recipesColumns" 
            ShowIndex=true />
    }
    else
    {
        @foreach (var recipe in _recipes)
        {
            <Card Width="300" ImageUrl="@recipe.ImageUrl" Title="@recipe.Title" OnClick="() => NavigateToDetail(recipe.Id)">
                <CardContent>
                    <Lable Darken=true Icon="fa-regular fa-hourglass-half" Text="@recipe.Duration.TotalMinutes" />
                    <Lable Darken=true Icon="fa-solid fa-bowl-rice" Text="@recipe.Portions" />
                    <Lable Darken=true Icon="fa-solid fa-bag-shopping" Text="@recipe.FoodCount" />
                    <Lable Darken=true Icon="fa-solid fa-money-bill" Text="@recipe.PricePerPortion.ToString("#.00")" />
                </CardContent>
            </Card>
        }
    }
</Panel>